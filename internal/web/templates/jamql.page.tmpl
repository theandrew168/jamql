{{template "base" .}}

<!--

TODO:

dynamic number of filter boxes (add, remove)
	show/hide, reset when hidden

save goes active after successful search
	only success, no error + no empty

clear error flash upon success? or upon button click?

-->

{{define "main"}}
<div class="jamql-bg">
	<div class="jamql">
		<!-- element for flash messages -->
		<div id="flash"></div>

		<form x-data="{ saveReady: false }">
			<!-- filter boxes -->
			{{range .}}
				{{template "filter" .}}
			{{end}}

			<!-- add filter button -->
			<div class="filter-add">
				<button class="filter-add-button" type="button">Add Filter</button>
			</div>

			<!-- save / search buttons -->
			<div class="save-search">
				<button class="button" hx-post="/search" hx-swap="innerHTML" hx-target="#tracks" hx-target-error="#flash" x-on:click="saveReady = true">
					<span>Search</span>
				</button>
				<button class="button" hx-post="/save" hx-swap="innerHTML" hx-target="#flash" hx-target-error="#flash" x-on:click="saveReady = false" x-bind:disabled="!saveReady">
					<span>Save</span>
				</button>
			</div>
		</form>

		<!-- tracks -->
		<div id="tracks">
			<!-- no tracks placeholder -->
			<div class="no-tracks">
				<p>Search to see some tracks!</p>
			</div>
		</div>

	</div>
</div>
{{end}}
